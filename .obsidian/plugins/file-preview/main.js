/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => FilePreview
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var FilePreview = class extends import_obsidian.Plugin {
  constructor() {
    super(...arguments);
    this.previewContentsEl = [];
  }
  async onload() {
    await this.loadSettings();
    this.addSettingTab(new FilePreviewSettingTab(this.app, this));
    await this.initialize();
    this.addRibbonIcon("refresh-cw", "Refresh preview contents", async () => {
      this.refreshPreviewContents();
    });
    this.addRibbonIcon("trash", "Delete preview contents", async () => {
      this.deletePreviewContents();
    });
    this.ttl = 5;
    (0, import_obsidian.addIcon)("captions", '<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-captions"><rect width="18" height="14" x="3" y="5" rx="2" ry="2"/><path d="M7 15h4M15 15h2M7 11h2M13 11h4"/></svg>');
    (0, import_obsidian.addIcon)("captions-off", '<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-captions-off"><path d="M10.5 5H19a2 2 0 0 1 2 2v8.5"/><path d="M17 11h-.5"/><path d="M19 19H5a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2"/><path d="m2 2 20 20"/><path d="M7 11h4"/><path d="M7 15h2.5"/></svg>');
    await this.saveSettings();
  }
  onunload() {
    this.showpreviewBtn.remove();
    this.deletePreviewContents();
    this.saveSettings();
  }
  async initialize() {
    this.app.workspace.onLayoutReady(async () => {
      try {
        this.fileExplorerView = await this.getFileExplorerView();
        this.fileNavEl = this.fileExplorerView.containerEl;
        this.initImagePaths();
        this.createShowPreviewButton(this.fileNavEl.querySelector(".nav-header > .nav-buttons-container"));
        if (this.settings.showpreview) {
          await this.refreshPreviewContents();
        }
      } catch (err) {
        console.log(err);
        if (this.ttl <= 0) {
          return;
        }
        this.ttl -= 1;
        setTimeout(() => {
          this.initialize();
        }, 1e3);
      }
    });
  }
  createShowPreviewButton(fileNavHeader) {
    if (this.showpreviewBtn) {
      return;
    }
    this.showpreviewBtn = fileNavHeader.createDiv({ cls: "clickable-icon nav-action-button show-preview-button", attr: { "aria-label": "Show/Hide preview contents" } });
    if (this.settings.ispreview) {
      (0, import_obsidian.setIcon)(this.showpreviewBtn, "captions-off");
    } else {
      (0, import_obsidian.setIcon)(this.showpreviewBtn, "captions");
    }
    this.registerDomEvent(this.showpreviewBtn, "click", async () => {
      if (this.settings.ispreview) {
        this.deletePreviewContents();
        (0, import_obsidian.setIcon)(this.showpreviewBtn, "captions-off");
      } else {
        await this.displayPreviewContents();
        (0, import_obsidian.setIcon)(this.showpreviewBtn, "captions");
      }
    });
    this.saveSettings();
  }
  async displayPreviewContents() {
    this.fileNavEl.classList.add("file-preview-nav");
    const fileItems = this.fileExplorerView.fileItems;
    if (this.settings.showImg) {
      for (const path in fileItems) {
        const item = fileItems[path];
        if (path === "/" || !(item.file instanceof import_obsidian.TFile) || item.file.extension !== "md") {
          continue;
        }
        await this.app.vault.cachedRead(item.file).then((contents) => {
          const formattedContents = this.formatContents(contents.trim());
          let imgpath = this.getFirstImgPath(contents);
          if (formattedContents) {
            item.selfEl.classList.add("file-preview-nav-file-title");
            this.previewContentsEl.push(item.selfEl.createEl("div", {
              text: formattedContents,
              attr: {
                class: "tree-item-inner nav-file-details",
                style: `-webkit-line-clamp: ${this.settings.lineClamp}; text-indent: ${this.settings.indents}em;`
              }
            }));
            if (imgpath) {
              item.el.classList.add("file-preview-show-img");
              const fileimg = item.el.createEl("div", {
                attr: {
                  class: "tree-item-inner nav-file-img"
                }
              });
              if (!imgpath.startsWith("http")) {
                const absolutePath = this.imagePaths.find((path2) => path2.endsWith(imgpath)) || imgpath;
                imgpath = this.app.vault.adapter.getResourcePath((0, import_obsidian.normalizePath)(absolutePath));
              }
              fileimg.createEl("div", {
                attr: {
                  class: "preview-img",
                  style: `background-image: url(${imgpath})`
                }
              });
              this.previewContentsEl.push(fileimg);
            }
          }
        });
      }
    } else {
      for (const path in fileItems) {
        const item = fileItems[path];
        if (path === "/" || !(item.file instanceof import_obsidian.TFile) || item.file.extension !== "md") {
          continue;
        }
        await this.app.vault.cachedRead(item.file).then((contents) => {
          const formattedContents = this.formatContents(contents.trim());
          if (formattedContents) {
            item.selfEl.classList.add("file-preview-nav-file-title");
            this.previewContentsEl.push(item.selfEl.createEl("div", {
              text: formattedContents,
              attr: {
                class: "tree-item-inner nav-file-details",
                style: `-webkit-line-clamp: ${this.settings.lineClamp}; text-indent: ${this.settings.indents}em;`
              }
            }));
          }
        });
      }
    }
    this.settings.ispreview = true;
  }
  async getFileExplorerView() {
    return new Promise((resolve, reject) => {
      let foundLeaf = null;
      const leafs = this.app.workspace.getLeavesOfType("file-explorer");
      if (leafs.length === 0) {
        reject(Error("Could not find file explorer view."));
      } else {
        foundLeaf = leafs[0];
        resolve(foundLeaf.view);
      }
      if (!foundLeaf) {
        reject(Error("Could not find file explorer view."));
      }
    });
  }
  async deletePreviewContents() {
    this.previewContentsEl.forEach((el) => {
      el.remove();
    });
    this.previewContentsEl = [];
    this.settings.ispreview = false;
  }
  async refreshPreviewContents() {
    if (this.settings.ispreview) {
      this.deletePreviewContents();
    }
    this.displayPreviewContents();
  }
  formatContents(contents) {
    let formatContents = contents;
    if (contents.startsWith("---") && this.settings.format.frontmatter) {
      formatContents = contents.replace(/---[\s\S]*?---/, "");
    }
    if (this.settings.format.bolditalic) {
      formatContents = formatContents.replace(/(\*\*|__)(.*?)\1/g, "$2");
      formatContents = formatContents.replace(/(\*|_)(.*?)\1/g, "$2");
    }
    if (this.settings.format.highlight) {
      formatContents = formatContents.replace(/===(.*?)===/g, "$1");
    }
    if (this.settings.format.codeblock) {
      formatContents = formatContents.replace(/`{5}[\s\S]*?`{5}/g, "");
      formatContents = formatContents.replace(/`{4}[\s\S]*?`{4}/g, "");
      formatContents = formatContents.replace(/`{3}[\s\S]*?`{3}/g, "");
    }
    if (this.settings.format.quote) {
      formatContents = formatContents.replace(/(^>.*\n*)+/g, "");
    }
    if (this.settings.format.blankline) {
      formatContents = formatContents.replace(/^\s*\n/g, "");
    }
    formatContents = formatContents.replace(/#+/g, "");
    formatContents = formatContents.replace(/!\[.*?\]\(.*?\)/g, "");
    formatContents = formatContents.replace(/\[\[.*?\]\]/g, "");
    formatContents = formatContents.replace(/\[.*?\]\(.*?\)/g, "");
    return formatContents.slice(0, parseInt(this.settings.previewcontentslength)).trim();
  }
  getFirstImgPath(contents) {
    const imgReg = /!\[\[(.*?)\](?!\|bb\]\])|!\[(.*?)\]\((.*?)\)/;
    const ImgMatch = contents.match(imgReg);
    if (ImgMatch) {
      const imgPath = ImgMatch[1] || ImgMatch[3];
      if (imgPath.includes("|")) {
        return imgPath.split("|")[0];
      }
      return imgPath;
    }
    return "";
  }
  async initImagePaths() {
    const allpaths = this.app.vault.getFiles().map((file) => file.path);
    const imgpaths = allpaths.filter((path) => this.pathIsImg(path));
    this.imagePaths = imgpaths;
  }
  pathIsImg(path) {
    return path.endsWith(".png") || path.endsWith(".jpg") || path.endsWith(".jpeg") || path.endsWith(".gif") || path.endsWith(".webp");
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
var DEFAULT_SETTINGS = {
  showpreview: true,
  lineClamp: 2,
  indents: 0,
  previewcontentslength: "50",
  ispreview: false,
  format: {
    frontmatter: true,
    bolditalic: true,
    highlight: true,
    codeblock: true,
    quote: true,
    blankline: true,
    title: true
  },
  showImg: true
};
var FilePreviewSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian.Setting(containerEl).setName("Show preview contents").setDesc("Show preview contents in the file explorer.").addToggle((toggle) => toggle.setValue(this.plugin.settings.showpreview).onChange(async (value) => {
      this.plugin.settings.showpreview = value;
      if (value) {
        await this.plugin.initialize();
      } else {
        await this.plugin.deletePreviewContents();
      }
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Show image").setDesc("Show image in the preview contents from file content.").addToggle((toggle) => toggle.setValue(this.plugin.settings.showImg).onChange(async (value) => {
      this.plugin.settings.showImg = value;
      await this.plugin.refreshPreviewContents();
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Length of the preview contents.").setDesc("default: 50").addText((text) => text.setPlaceholder("50").setValue(this.plugin.settings.previewcontentslength).onChange(async (value) => {
      this.plugin.settings.previewcontentslength = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Line clamp").setDesc("The number of lines to show in the preview contents.(1 - 10, default: 2).").addSlider(
      (slider) => slider.setLimits(1, 10, 1).setValue(this.plugin.settings.lineClamp).onChange(async (value) => {
        this.plugin.settings.lineClamp = value;
        await this.plugin.refreshPreviewContents();
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Indents of the preview contents").setDesc("The indents of the preview contents.").addSlider((slider) => slider.setLimits(0, 10, 1).setValue(this.plugin.settings.indents).onChange(async (value) => {
      this.plugin.settings.indents = value;
      await this.plugin.refreshPreviewContents();
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Format preview contents").setHeading();
    new import_obsidian.Setting(containerEl).setName("Remove frontmatter").setDesc("Remove frontmatter of the file.").addToggle((toggle) => toggle.setValue(this.plugin.settings.format.frontmatter).onChange(async (value) => {
      this.plugin.settings.format.frontmatter = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Remove bold and italic symbols").setDesc("Remove bold and italic symbols of the file.").addToggle((toggle) => toggle.setValue(this.plugin.settings.format.bolditalic).onChange(async (value) => {
      this.plugin.settings.format.bolditalic = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Remove highlight symbols").setDesc("Remove highlight symbols of the file.").addToggle((toggle) => toggle.setValue(this.plugin.settings.format.highlight).onChange(async (value) => {
      this.plugin.settings.format.highlight = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Remove code block").setDesc("Remove code block of the file.").addToggle((toggle) => toggle.setValue(this.plugin.settings.format.codeblock).onChange(async (value) => {
      this.plugin.settings.format.codeblock = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Remove quote").setDesc("Remove quote of the file.").addToggle((toggle) => toggle.setValue(this.plugin.settings.format.quote).onChange(async (value) => {
      this.plugin.settings.format.quote = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Remove blank line").setDesc("Remove blank line of the file.").addToggle((toggle) => toggle.setValue(this.plugin.settings.format.blankline).onChange(async (value) => {
      this.plugin.settings.format.blankline = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Remove title symbol").setDesc("Remove title symbol of the file.").addToggle((toggle) => toggle.setValue(this.plugin.settings.format.title).onChange(async (value) => {
      this.plugin.settings.format.title = value;
      await this.plugin.saveSettings();
    }));
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vLi4vRmlsZS1QcmV2aWV3L3NyYy9tYWluLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBBcHAsIFBsdWdpbiwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgVEZpbGUsIFRGb2xkZXIsIFZpZXcsIFdvcmtzcGFjZUxlYWYsIGFkZEljb24sIG5vcm1hbGl6ZVBhdGgsIHNldEljb24gfSBmcm9tICdvYnNpZGlhbic7XG5cbmRlY2xhcmUgbW9kdWxlICdvYnNpZGlhbicge1xuICBpbnRlcmZhY2UgV29ya3NwYWNlU2lkZWRvY2sge1xuICAgIGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudDtcbiAgfVxuICBpbnRlcmZhY2UgV29ya3NwYWNlTW9iaWxlRHJhd2VyIHtcbiAgICBjb250YWluZXJFbDogSFRNTEVsZW1lbnQ7XG4gIH1cbiAgaW50ZXJmYWNlIFRGb2xkZXIge1xuICAgIGV4dGVuc2lvbjogc3RyaW5nO1xuICB9XG4gIGludGVyZmFjZSBURmlsZSB7XG4gICAgZXh0ZW5zaW9uOiBzdHJpbmc7XG4gIH1cbn1cblxuaW50ZXJmYWNlIEZpbGVJdGVtIHtcbiAgdGl0bGVFbDogSFRNTEVsZW1lbnQ7XG4gIGVsOiBIVE1MRWxlbWVudDtcbiAgc2VsZkVsOiBIVE1MRWxlbWVudDtcbiAgZmlsZTogVEZpbGUgfCBURm9sZGVyO1xufVxuXG5pbnRlcmZhY2UgRmlsZVByZXZpZXdTZXR0aW5ncyB7XG4gIHNob3dwcmV2aWV3OiBib29sZWFuO1xuICBsaW5lQ2xhbXA6IG51bWJlcjtcbiAgaW5kZW50czogbnVtYmVyO1xuICBwcmV2aWV3Y29udGVudHNsZW5ndGg6IHN0cmluZztcbiAgaXNwcmV2aWV3OiBib29sZWFuO1xuICBmb3JtYXQ6IEZvcm1hdFNldHRpbmc7XG4gIHNob3dJbWc6IGJvb2xlYW47XG59XG5cbmludGVyZmFjZSBGaWxlRXhwbG9yZXJMZWFmIGV4dGVuZHMgV29ya3NwYWNlTGVhZiB7XG4gIHZpZXc6IEZpbGVFeHBsb3JlclZpZXc7XG59XG5cbmludGVyZmFjZSBGaWxlRXhwbG9yZXJWaWV3IGV4dGVuZHMgVmlldyB7XG4gIGZpbGVJdGVtczogeyBbcGF0aDogc3RyaW5nXTogRmlsZUl0ZW0gfTtcbn1cblxuaW50ZXJmYWNlIEZvcm1hdFNldHRpbmcge1xuICBmcm9udG1hdHRlcjogYm9vbGVhbjtcbiAgYm9sZGl0YWxpYzogYm9vbGVhbjtcbiAgaGlnaGxpZ2h0OiBib29sZWFuO1xuICBjb2RlYmxvY2s6IGJvb2xlYW47XG4gIHF1b3RlOiBib29sZWFuO1xuICBibGFua2xpbmU6IGJvb2xlYW47XG4gIHRpdGxlOiBib29sZWFuO1xufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGaWxlUHJldmlldyBleHRlbmRzIFBsdWdpbiB7XG4gIHNldHRpbmdzOiBGaWxlUHJldmlld1NldHRpbmdzO1xuICBmaWxlRXhwbG9yZXJWaWV3OiBGaWxlRXhwbG9yZXJWaWV3O1xuICBmaWxlTmF2RWw6IEhUTUxFbGVtZW50O1xuICBzaG93cHJldmlld0J0bjogSFRNTEVsZW1lbnQ7XG4gIHByZXZpZXdDb250ZW50c0VsOiBIVE1MRWxlbWVudFtdID0gW107XG4gIGltYWdlUGF0aHM6IHN0cmluZ1tdO1xuICB0dGw6IG51bWJlcjtcblxuICBhc3luYyBvbmxvYWQoKSB7XG4gICAgYXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcbiAgICB0aGlzLmFkZFNldHRpbmdUYWIobmV3IEZpbGVQcmV2aWV3U2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuXG4gICAgYXdhaXQgdGhpcy5pbml0aWFsaXplKCk7XG4gICAgdGhpcy5hZGRSaWJib25JY29uKCdyZWZyZXNoLWN3JywgJ1JlZnJlc2ggcHJldmlldyBjb250ZW50cycsIGFzeW5jICgpID0+IHtcbiAgICAgIHRoaXMucmVmcmVzaFByZXZpZXdDb250ZW50cygpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5hZGRSaWJib25JY29uKCd0cmFzaCcsICdEZWxldGUgcHJldmlldyBjb250ZW50cycsIGFzeW5jICgpID0+IHtcbiAgICAgIHRoaXMuZGVsZXRlUHJldmlld0NvbnRlbnRzKCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLnR0bCA9IDU7XG4gICAgXG4gICAgYWRkSWNvbignY2FwdGlvbnMnLCAnPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgd2lkdGg9XCIxMDBcIiBoZWlnaHQ9XCIxMDBcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIgY2xhc3M9XCJsdWNpZGUgbHVjaWRlLWNhcHRpb25zXCI+PHJlY3Qgd2lkdGg9XCIxOFwiIGhlaWdodD1cIjE0XCIgeD1cIjNcIiB5PVwiNVwiIHJ4PVwiMlwiIHJ5PVwiMlwiLz48cGF0aCBkPVwiTTcgMTVoNE0xNSAxNWgyTTcgMTFoMk0xMyAxMWg0XCIvPjwvc3ZnPicpO1xuICAgIGFkZEljb24oJ2NhcHRpb25zLW9mZicsICc8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjEwMFwiIGhlaWdodD1cIjEwMFwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIiBjbGFzcz1cImx1Y2lkZSBsdWNpZGUtY2FwdGlvbnMtb2ZmXCI+PHBhdGggZD1cIk0xMC41IDVIMTlhMiAyIDAgMCAxIDIgMnY4LjVcIi8+PHBhdGggZD1cIk0xNyAxMWgtLjVcIi8+PHBhdGggZD1cIk0xOSAxOUg1YTIgMiAwIDAgMS0yLTJWN2EyIDIgMCAwIDEgMi0yXCIvPjxwYXRoIGQ9XCJtMiAyIDIwIDIwXCIvPjxwYXRoIGQ9XCJNNyAxMWg0XCIvPjxwYXRoIGQ9XCJNNyAxNWgyLjVcIi8+PC9zdmc+JylcblxuICAgIGF3YWl0IHRoaXMuc2F2ZVNldHRpbmdzKCk7XG4gIH1cblxuICBvbnVubG9hZCgpIHtcbiAgICB0aGlzLnNob3dwcmV2aWV3QnRuLnJlbW92ZSgpO1xuICAgIHRoaXMuZGVsZXRlUHJldmlld0NvbnRlbnRzKCk7XG4gICAgdGhpcy5zYXZlU2V0dGluZ3MoKTtcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyBpbml0aWFsaXplKCkge1xuICAgIHRoaXMuYXBwLndvcmtzcGFjZS5vbkxheW91dFJlYWR5KGFzeW5jICgpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHRoaXMuZmlsZUV4cGxvcmVyVmlldyA9IGF3YWl0IHRoaXMuZ2V0RmlsZUV4cGxvcmVyVmlldygpOyAvLyBcdTZENEJcdThCRDVcdTY1ODdcdTRFRjZcdTU5MzlcdTY4MTFcdTY2MkZcdTU0MjZcdTUyQTBcdThGN0RcbiAgICAgICAgdGhpcy5maWxlTmF2RWwgPSB0aGlzLmZpbGVFeHBsb3JlclZpZXcuY29udGFpbmVyRWw7XG4gICAgICAgIHRoaXMuaW5pdEltYWdlUGF0aHMoKTtcbiAgICAgICAgdGhpcy5jcmVhdGVTaG93UHJldmlld0J1dHRvbih0aGlzLmZpbGVOYXZFbC5xdWVyeVNlbGVjdG9yKCcubmF2LWhlYWRlciA+IC5uYXYtYnV0dG9ucy1jb250YWluZXInKSBhcyBIVE1MRWxlbWVudCk7XG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLnNob3dwcmV2aWV3KSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5yZWZyZXNoUHJldmlld0NvbnRlbnRzKCk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICBpZiAodGhpcy50dGwgPD0gMCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvLyBGaWxlIEV4cGxvcmVyIHBhbmUgbWF5IG5vdCBiZSBsb2FkZWQgeWV0XG4gICAgICAgIHRoaXMudHRsIC09IDE7XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZSgpO1xuICAgICAgICB9LCAxMDAwKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHB1YmxpYyBjcmVhdGVTaG93UHJldmlld0J1dHRvbihmaWxlTmF2SGVhZGVyOiBIVE1MRWxlbWVudCkge1xuICAgIGlmICh0aGlzLnNob3dwcmV2aWV3QnRuKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuc2hvd3ByZXZpZXdCdG4gPSBmaWxlTmF2SGVhZGVyLmNyZWF0ZURpdih7IGNsczogJ2NsaWNrYWJsZS1pY29uIG5hdi1hY3Rpb24tYnV0dG9uIHNob3ctcHJldmlldy1idXR0b24nLCBhdHRyOiB7ICdhcmlhLWxhYmVsJzogJ1Nob3cvSGlkZSBwcmV2aWV3IGNvbnRlbnRzJyB9IH0pO1xuICAgIGlmICh0aGlzLnNldHRpbmdzLmlzcHJldmlldykge1xuICAgICAgc2V0SWNvbih0aGlzLnNob3dwcmV2aWV3QnRuLCAnY2FwdGlvbnMtb2ZmJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNldEljb24odGhpcy5zaG93cHJldmlld0J0biwgJ2NhcHRpb25zJyk7XG4gICAgfVxuICAgIHRoaXMucmVnaXN0ZXJEb21FdmVudCh0aGlzLnNob3dwcmV2aWV3QnRuLCAnY2xpY2snLCBhc3luYyAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5zZXR0aW5ncy5pc3ByZXZpZXcpIHtcbiAgICAgICAgdGhpcy5kZWxldGVQcmV2aWV3Q29udGVudHMoKTtcbiAgICAgICAgc2V0SWNvbih0aGlzLnNob3dwcmV2aWV3QnRuLCAnY2FwdGlvbnMtb2ZmJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhd2FpdCB0aGlzLmRpc3BsYXlQcmV2aWV3Q29udGVudHMoKTtcbiAgICAgICAgc2V0SWNvbih0aGlzLnNob3dwcmV2aWV3QnRuLCAnY2FwdGlvbnMnKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICB0aGlzLnNhdmVTZXR0aW5ncygpO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIGRpc3BsYXlQcmV2aWV3Q29udGVudHMoKSB7XG4gICAgdGhpcy5maWxlTmF2RWwuY2xhc3NMaXN0LmFkZCgnZmlsZS1wcmV2aWV3LW5hdicpO1xuICAgIGNvbnN0IGZpbGVJdGVtcyA9IHRoaXMuZmlsZUV4cGxvcmVyVmlldy5maWxlSXRlbXM7XG4gICAgaWYgKHRoaXMuc2V0dGluZ3Muc2hvd0ltZykge1xuICAgICAgZm9yIChjb25zdCBwYXRoIGluIGZpbGVJdGVtcykge1xuICAgICAgICBjb25zdCBpdGVtID0gZmlsZUl0ZW1zW3BhdGhdO1xuICAgICAgICBpZiAocGF0aCA9PT0gJy8nIHx8ICEoaXRlbS5maWxlIGluc3RhbmNlb2YgVEZpbGUpIHx8IGl0ZW0uZmlsZS5leHRlbnNpb24gIT09ICdtZCcpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQuY2FjaGVkUmVhZChpdGVtLmZpbGUpLnRoZW4oKGNvbnRlbnRzKSA9PiB7XG4gICAgICAgICAgY29uc3QgZm9ybWF0dGVkQ29udGVudHMgPSB0aGlzLmZvcm1hdENvbnRlbnRzKGNvbnRlbnRzLnRyaW0oKSk7XG4gICAgICAgICAgbGV0IGltZ3BhdGggPSB0aGlzLmdldEZpcnN0SW1nUGF0aChjb250ZW50cyk7XG4gICAgICAgICAgaWYgKGZvcm1hdHRlZENvbnRlbnRzKSB7XG4gICAgICAgICAgICBpdGVtLnNlbGZFbC5jbGFzc0xpc3QuYWRkKCdmaWxlLXByZXZpZXctbmF2LWZpbGUtdGl0bGUnKTtcbiAgICAgICAgICAgIHRoaXMucHJldmlld0NvbnRlbnRzRWwucHVzaChpdGVtLnNlbGZFbC5jcmVhdGVFbCgnZGl2Jywge1xuICAgICAgICAgICAgICB0ZXh0OiBmb3JtYXR0ZWRDb250ZW50cyxcbiAgICAgICAgICAgICAgYXR0cjoge1xuICAgICAgICAgICAgICAgIGNsYXNzOiAndHJlZS1pdGVtLWlubmVyIG5hdi1maWxlLWRldGFpbHMnLFxuICAgICAgICAgICAgICAgIHN0eWxlOiBgLXdlYmtpdC1saW5lLWNsYW1wOiAke3RoaXMuc2V0dGluZ3MubGluZUNsYW1wfTsgdGV4dC1pbmRlbnQ6ICR7dGhpcy5zZXR0aW5ncy5pbmRlbnRzfWVtO2BcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgaWYgKGltZ3BhdGgpIHtcbiAgICAgICAgICAgICAgaXRlbS5lbC5jbGFzc0xpc3QuYWRkKCdmaWxlLXByZXZpZXctc2hvdy1pbWcnKTtcbiAgICAgICAgICAgICAgY29uc3QgZmlsZWltZyA9IGl0ZW0uZWwuY3JlYXRlRWwoJ2RpdicsIHtcbiAgICAgICAgICAgICAgICBhdHRyOiB7XG4gICAgICAgICAgICAgICAgICBjbGFzczogJ3RyZWUtaXRlbS1pbm5lciBuYXYtZmlsZS1pbWcnLFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgaWYgKCFpbWdwYXRoLnN0YXJ0c1dpdGgoJ2h0dHAnKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGFic29sdXRlUGF0aCA9IHRoaXMuaW1hZ2VQYXRocy5maW5kKChwYXRoKSA9PiBwYXRoLmVuZHNXaXRoKGltZ3BhdGgpKSB8fCBpbWdwYXRoO1xuICAgICAgICAgICAgICAgIGltZ3BhdGggPSB0aGlzLmFwcC52YXVsdC5hZGFwdGVyLmdldFJlc291cmNlUGF0aChub3JtYWxpemVQYXRoKChhYnNvbHV0ZVBhdGgpKSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZmlsZWltZy5jcmVhdGVFbCgnZGl2Jywge1xuICAgICAgICAgICAgICAgIGF0dHI6IHtcbiAgICAgICAgICAgICAgICAgIGNsYXNzOiAncHJldmlldy1pbWcnLFxuICAgICAgICAgICAgICAgICAgc3R5bGU6IGBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoJHtpbWdwYXRofSlgLFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHRoaXMucHJldmlld0NvbnRlbnRzRWwucHVzaChmaWxlaW1nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBmb3IgKGNvbnN0IHBhdGggaW4gZmlsZUl0ZW1zKSB7XG4gICAgICAgIGNvbnN0IGl0ZW0gPSBmaWxlSXRlbXNbcGF0aF07XG4gICAgICAgIGlmIChwYXRoID09PSAnLycgfHwgIShpdGVtLmZpbGUgaW5zdGFuY2VvZiBURmlsZSkgfHwgaXRlbS5maWxlLmV4dGVuc2lvbiAhPT0gJ21kJykge1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNhY2hlZFJlYWQoaXRlbS5maWxlKS50aGVuKChjb250ZW50cykgPT4ge1xuICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZENvbnRlbnRzID0gdGhpcy5mb3JtYXRDb250ZW50cyhjb250ZW50cy50cmltKCkpO1xuICAgICAgICAgIGlmIChmb3JtYXR0ZWRDb250ZW50cykge1xuICAgICAgICAgICAgaXRlbS5zZWxmRWwuY2xhc3NMaXN0LmFkZCgnZmlsZS1wcmV2aWV3LW5hdi1maWxlLXRpdGxlJyk7XG4gICAgICAgICAgICB0aGlzLnByZXZpZXdDb250ZW50c0VsLnB1c2goaXRlbS5zZWxmRWwuY3JlYXRlRWwoJ2RpdicsIHtcbiAgICAgICAgICAgICAgdGV4dDogZm9ybWF0dGVkQ29udGVudHMsXG4gICAgICAgICAgICAgIGF0dHI6IHtcbiAgICAgICAgICAgICAgICBjbGFzczogJ3RyZWUtaXRlbS1pbm5lciBuYXYtZmlsZS1kZXRhaWxzJyxcbiAgICAgICAgICAgICAgICBzdHlsZTogYC13ZWJraXQtbGluZS1jbGFtcDogJHt0aGlzLnNldHRpbmdzLmxpbmVDbGFtcH07IHRleHQtaW5kZW50OiAke3RoaXMuc2V0dGluZ3MuaW5kZW50c31lbTtgXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLnNldHRpbmdzLmlzcHJldmlldyA9IHRydWU7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgZ2V0RmlsZUV4cGxvcmVyVmlldygpOiBQcm9taXNlPEZpbGVFeHBsb3JlclZpZXc+IHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgbGV0IGZvdW5kTGVhZjogRmlsZUV4cGxvcmVyTGVhZiB8IG51bGwgPSBudWxsO1xuICAgICAgY29uc3QgbGVhZnMgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFwiZmlsZS1leHBsb3JlclwiKSBhcyBGaWxlRXhwbG9yZXJMZWFmW107XG4gICAgICBpZiAobGVhZnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJlamVjdChFcnJvcihcIkNvdWxkIG5vdCBmaW5kIGZpbGUgZXhwbG9yZXIgdmlldy5cIikpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZm91bmRMZWFmID0gbGVhZnNbMF07XG4gICAgICAgIHJlc29sdmUoZm91bmRMZWFmLnZpZXcpO1xuICAgICAgfVxuICAgICAgaWYgKCFmb3VuZExlYWYpIHtcbiAgICAgICAgcmVqZWN0KEVycm9yKFwiQ291bGQgbm90IGZpbmQgZmlsZSBleHBsb3JlciB2aWV3LlwiKSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgZGVsZXRlUHJldmlld0NvbnRlbnRzKCkge1xuICAgIHRoaXMucHJldmlld0NvbnRlbnRzRWwuZm9yRWFjaCgoZWwpID0+IHtcbiAgICAgIGVsLnJlbW92ZSgpO1xuICAgIH0pO1xuICAgIHRoaXMucHJldmlld0NvbnRlbnRzRWwgPSBbXTtcbiAgICB0aGlzLnNldHRpbmdzLmlzcHJldmlldyA9IGZhbHNlO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIHJlZnJlc2hQcmV2aWV3Q29udGVudHMoKSB7XG4gICAgaWYgKHRoaXMuc2V0dGluZ3MuaXNwcmV2aWV3KSB7XG4gICAgICB0aGlzLmRlbGV0ZVByZXZpZXdDb250ZW50cygpO1xuICAgIH1cbiAgICB0aGlzLmRpc3BsYXlQcmV2aWV3Q29udGVudHMoKTtcbiAgfVxuXG4gIHB1YmxpYyBmb3JtYXRDb250ZW50cyhjb250ZW50czogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBsZXQgZm9ybWF0Q29udGVudHMgPSBjb250ZW50cztcbiAgICAvLyBSZW1vdmUgZnJvbnRtYXR0ZXJcbiAgICBpZiAoY29udGVudHMuc3RhcnRzV2l0aCgnLS0tJykgJiYgdGhpcy5zZXR0aW5ncy5mb3JtYXQuZnJvbnRtYXR0ZXIpIHtcbiAgICAgIGZvcm1hdENvbnRlbnRzID0gY29udGVudHMucmVwbGFjZSgvLS0tW1xcc1xcU10qPy0tLS8sICcnKTtcbiAgICB9XG4gICAgLy8gUmVtb3ZlIGJvbGQgYW5kIGl0YWxpY1xuICAgIGlmICh0aGlzLnNldHRpbmdzLmZvcm1hdC5ib2xkaXRhbGljKSB7XG4gICAgICBmb3JtYXRDb250ZW50cyA9IGZvcm1hdENvbnRlbnRzLnJlcGxhY2UoLyhcXCpcXCp8X18pKC4qPylcXDEvZywgJyQyJyk7XG4gICAgICBmb3JtYXRDb250ZW50cyA9IGZvcm1hdENvbnRlbnRzLnJlcGxhY2UoLyhcXCp8XykoLio/KVxcMS9nLCAnJDInKTtcbiAgICB9XG4gICAgLy8gUmVtb3ZlIGhpZ2hsaWdodFxuICAgIGlmICh0aGlzLnNldHRpbmdzLmZvcm1hdC5oaWdobGlnaHQpIHtcbiAgICAgIGZvcm1hdENvbnRlbnRzID0gZm9ybWF0Q29udGVudHMucmVwbGFjZSgvPT09KC4qPyk9PT0vZywgJyQxJyk7XG4gICAgfVxuICAgIC8vIFJlbW92ZSBjb2RlIGJsb2NrXG4gICAgaWYgKHRoaXMuc2V0dGluZ3MuZm9ybWF0LmNvZGVibG9jaykge1xuICAgICAgZm9ybWF0Q29udGVudHMgPSBmb3JtYXRDb250ZW50cy5yZXBsYWNlKC9gezV9W1xcc1xcU10qP2B7NX0vZywgJycpO1xuICAgICAgZm9ybWF0Q29udGVudHMgPSBmb3JtYXRDb250ZW50cy5yZXBsYWNlKC9gezR9W1xcc1xcU10qP2B7NH0vZywgJycpO1xuICAgICAgZm9ybWF0Q29udGVudHMgPSBmb3JtYXRDb250ZW50cy5yZXBsYWNlKC9gezN9W1xcc1xcU10qP2B7M30vZywgJycpO1xuICAgIH1cbiAgICAvLyBSZW1vdmUgcXVvdGUgJz4gLi5cXG4+Li4nXG4gICAgaWYgKHRoaXMuc2V0dGluZ3MuZm9ybWF0LnF1b3RlKSB7XG4gICAgICBmb3JtYXRDb250ZW50cyA9IGZvcm1hdENvbnRlbnRzLnJlcGxhY2UoLyhePi4qXFxuKikrL2csICcnKTtcbiAgICB9XG4gICAgLy8gY2xlYXIgYmxhbmsgbGluZVxuICAgIGlmICh0aGlzLnNldHRpbmdzLmZvcm1hdC5ibGFua2xpbmUpIHtcbiAgICAgIGZvcm1hdENvbnRlbnRzID0gZm9ybWF0Q29udGVudHMucmVwbGFjZSgvXlxccypcXG4vZywgJycpO1xuICAgIH1cbiAgICAvLyBSZW1vdmUgdGl0bGUgc3ltYm9sXG4gICAgZm9ybWF0Q29udGVudHMgPSBmb3JtYXRDb250ZW50cy5yZXBsYWNlKC8jKy9nLCAnJyk7XG5cbiAgICAvLyBSZW1vdmUgd2lraSBsaW5rOiBbW11dICYgbWFya2Rvd24gbGluazogW10oKSAmIGltYWdlIGxpbms6ICFbXSgpXG4gICAgZm9ybWF0Q29udGVudHMgPSBmb3JtYXRDb250ZW50cy5yZXBsYWNlKC8hXFxbLio/XFxdXFwoLio/XFwpL2csICcnKTtcbiAgICBmb3JtYXRDb250ZW50cyA9IGZvcm1hdENvbnRlbnRzLnJlcGxhY2UoL1xcW1xcWy4qP1xcXVxcXS9nLCAnJyk7XG4gICAgZm9ybWF0Q29udGVudHMgPSBmb3JtYXRDb250ZW50cy5yZXBsYWNlKC9cXFsuKj9cXF1cXCguKj9cXCkvZywgJycpO1xuXG4gICAgcmV0dXJuIGZvcm1hdENvbnRlbnRzLnNsaWNlKDAsIHBhcnNlSW50KHRoaXMuc2V0dGluZ3MucHJldmlld2NvbnRlbnRzbGVuZ3RoKSkudHJpbSgpO1xuICB9XG5cbiAgcHVibGljIGdldEZpcnN0SW1nUGF0aChjb250ZW50czogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAvLyBcdTZCNjNcdTUyMTlcdTUzMzlcdTkxNERcdTgzQjdcdTUzRDYgIVtbXV0sICFbXSgpIFx1NzY4NFx1NTZGRVx1NzI0N1x1OERFRlx1NUY4NFx1RkYwQ1x1NTMzOVx1OTE0RFx1N0IyQ1x1NEUwMFx1NEUyQVx1RkYwQ1x1NTIyNFx1NjVBRFx1NTQwRVx1N0YwMFx1NjYyRlx1NTQyNlx1NEUzQVx1NTZGRVx1NzI0N1x1NjgzQ1x1NUYwRlxuICAgIGNvbnN0IGltZ1JlZyA9IC8hXFxbXFxbKC4qPylcXF0oPyFcXHxiYlxcXVxcXSl8IVxcWyguKj8pXFxdXFwoKC4qPylcXCkvO1xuXG4gICAgY29uc3QgSW1nTWF0Y2ggPSBjb250ZW50cy5tYXRjaChpbWdSZWcpO1xuICAgIGlmIChJbWdNYXRjaCkge1xuICAgICAgY29uc3QgaW1nUGF0aCA9IEltZ01hdGNoWzFdIHx8IEltZ01hdGNoWzNdO1xuICAgICAgaWYgKGltZ1BhdGguaW5jbHVkZXMoJ3wnKSApIHtcbiAgICAgICAgcmV0dXJuIGltZ1BhdGguc3BsaXQoJ3wnKVswXTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBpbWdQYXRoO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gJyc7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgaW5pdEltYWdlUGF0aHMoKSB7XG4gICAgY29uc3QgYWxscGF0aHMgPSB0aGlzLmFwcC52YXVsdC5nZXRGaWxlcygpLm1hcCgoZmlsZSkgPT4gZmlsZS5wYXRoKTtcbiAgICBjb25zdCBpbWdwYXRocyA9IGFsbHBhdGhzLmZpbHRlcigocGF0aCkgPT4gdGhpcy5wYXRoSXNJbWcocGF0aCkpO1xuICAgIHRoaXMuaW1hZ2VQYXRocyA9IGltZ3BhdGhzO1xuICB9XG5cbiAgcHVibGljIHBhdGhJc0ltZyhwYXRoOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICByZXR1cm4gcGF0aC5lbmRzV2l0aCgnLnBuZycpIHx8IHBhdGguZW5kc1dpdGgoJy5qcGcnKSB8fCBwYXRoLmVuZHNXaXRoKCcuanBlZycpIHx8IHBhdGguZW5kc1dpdGgoJy5naWYnKSB8fCBwYXRoLmVuZHNXaXRoKCcud2VicCcpO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcbiAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG4gICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcbiAgfVxufVxuXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBGaWxlUHJldmlld1NldHRpbmdzID0ge1xuICBzaG93cHJldmlldzogdHJ1ZSxcbiAgbGluZUNsYW1wOiAyLFxuICBpbmRlbnRzOiAwLFxuICBwcmV2aWV3Y29udGVudHNsZW5ndGg6ICc1MCcsXG4gIGlzcHJldmlldzogZmFsc2UsXG4gIGZvcm1hdDoge1xuICAgIGZyb250bWF0dGVyOiB0cnVlLFxuICAgIGJvbGRpdGFsaWM6IHRydWUsXG4gICAgaGlnaGxpZ2h0OiB0cnVlLFxuICAgIGNvZGVibG9jazogdHJ1ZSxcbiAgICBxdW90ZTogdHJ1ZSxcbiAgICBibGFua2xpbmU6IHRydWUsXG4gICAgdGl0bGU6IHRydWVcbiAgfSxcbiAgc2hvd0ltZzogdHJ1ZSxcbn1cblxuY2xhc3MgRmlsZVByZXZpZXdTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG4gIHBsdWdpbjogRmlsZVByZXZpZXc7XG5cbiAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogRmlsZVByZXZpZXcpIHtcbiAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gIH1cblxuICBkaXNwbGF5KCkge1xuICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXNcbiAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZShcIlNob3cgcHJldmlldyBjb250ZW50c1wiKVxuICAgICAgLnNldERlc2MoXCJTaG93IHByZXZpZXcgY29udGVudHMgaW4gdGhlIGZpbGUgZXhwbG9yZXIuXCIpXG4gICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dwcmV2aWV3KVxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2hvd3ByZXZpZXcgPSB2YWx1ZTtcbiAgICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmluaXRpYWxpemUoKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZGVsZXRlUHJldmlld0NvbnRlbnRzKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICB9KSk7XG5cbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgIC5zZXROYW1lKCdTaG93IGltYWdlJylcbiAgICAgIC5zZXREZXNjKFwiU2hvdyBpbWFnZSBpbiB0aGUgcHJldmlldyBjb250ZW50cyBmcm9tIGZpbGUgY29udGVudC5cIilcbiAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2hvd0ltZylcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dJbWcgPSB2YWx1ZTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5yZWZyZXNoUHJldmlld0NvbnRlbnRzKCk7XG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIH0pKTtcblxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgLnNldE5hbWUoXCJMZW5ndGggb2YgdGhlIHByZXZpZXcgY29udGVudHMuXCIpXG4gICAgICAuc2V0RGVzYyhcImRlZmF1bHQ6IDUwXCIpXG4gICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwiNTBcIilcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnByZXZpZXdjb250ZW50c2xlbmd0aClcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnByZXZpZXdjb250ZW50c2xlbmd0aCA9IHZhbHVlO1xuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICB9KSk7XG5cbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgIC5zZXROYW1lKFwiTGluZSBjbGFtcFwiKVxuICAgICAgLnNldERlc2MoXCJUaGUgbnVtYmVyIG9mIGxpbmVzIHRvIHNob3cgaW4gdGhlIHByZXZpZXcgY29udGVudHMuKDEgLSAxMCwgZGVmYXVsdDogMikuXCIpXG4gICAgICAuYWRkU2xpZGVyKHNsaWRlciA9PiBzbGlkZXJcbiAgICAgICAgLnNldExpbWl0cygxLCAxMCwgMSlcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpbmVDbGFtcClcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmxpbmVDbGFtcCA9IHZhbHVlO1xuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnJlZnJlc2hQcmV2aWV3Q29udGVudHMoKTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgfSlcbiAgICAgIClcblxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgLnNldE5hbWUoJ0luZGVudHMgb2YgdGhlIHByZXZpZXcgY29udGVudHMnKVxuICAgICAgLnNldERlc2MoJ1RoZSBpbmRlbnRzIG9mIHRoZSBwcmV2aWV3IGNvbnRlbnRzLicpXG4gICAgICAuYWRkU2xpZGVyKHNsaWRlciA9PiBzbGlkZXJcbiAgICAgICAgLnNldExpbWl0cygwLCAxMCwgMSlcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmluZGVudHMpXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmRlbnRzID0gdmFsdWU7XG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4ucmVmcmVzaFByZXZpZXdDb250ZW50cygpO1xuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICB9KSk7XG5cbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZSgnRm9ybWF0IHByZXZpZXcgY29udGVudHMnKS5zZXRIZWFkaW5nKCk7XG4gICAgICAgIFxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgLnNldE5hbWUoXCJSZW1vdmUgZnJvbnRtYXR0ZXJcIilcbiAgICAgIC5zZXREZXNjKFwiUmVtb3ZlIGZyb250bWF0dGVyIG9mIHRoZSBmaWxlLlwiKVxuICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5mb3JtYXQuZnJvbnRtYXR0ZXIpXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5mb3JtYXQuZnJvbnRtYXR0ZXIgPSB2YWx1ZTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgfSkpO1xuXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZShcIlJlbW92ZSBib2xkIGFuZCBpdGFsaWMgc3ltYm9sc1wiKVxuICAgICAgLnNldERlc2MoXCJSZW1vdmUgYm9sZCBhbmQgaXRhbGljIHN5bWJvbHMgb2YgdGhlIGZpbGUuXCIpXG4gICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmZvcm1hdC5ib2xkaXRhbGljKVxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZm9ybWF0LmJvbGRpdGFsaWMgPSB2YWx1ZTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgfSkpO1xuXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZShcIlJlbW92ZSBoaWdobGlnaHQgc3ltYm9sc1wiKVxuICAgICAgLnNldERlc2MoXCJSZW1vdmUgaGlnaGxpZ2h0IHN5bWJvbHMgb2YgdGhlIGZpbGUuXCIpXG4gICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmZvcm1hdC5oaWdobGlnaHQpXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5mb3JtYXQuaGlnaGxpZ2h0ID0gdmFsdWU7XG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIH0pKTtcblxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgLnNldE5hbWUoXCJSZW1vdmUgY29kZSBibG9ja1wiKVxuICAgICAgLnNldERlc2MoXCJSZW1vdmUgY29kZSBibG9jayBvZiB0aGUgZmlsZS5cIilcbiAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZm9ybWF0LmNvZGVibG9jaylcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmZvcm1hdC5jb2RlYmxvY2sgPSB2YWx1ZTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgfSkpO1xuXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZShcIlJlbW92ZSBxdW90ZVwiKVxuICAgICAgLnNldERlc2MoXCJSZW1vdmUgcXVvdGUgb2YgdGhlIGZpbGUuXCIpXG4gICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmZvcm1hdC5xdW90ZSlcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmZvcm1hdC5xdW90ZSA9IHZhbHVlO1xuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICB9KSk7XG5cbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgIC5zZXROYW1lKFwiUmVtb3ZlIGJsYW5rIGxpbmVcIilcbiAgICAgIC5zZXREZXNjKFwiUmVtb3ZlIGJsYW5rIGxpbmUgb2YgdGhlIGZpbGUuXCIpXG4gICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmZvcm1hdC5ibGFua2xpbmUpXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5mb3JtYXQuYmxhbmtsaW5lID0gdmFsdWU7XG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIH0pKTtcblxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgLnNldE5hbWUoXCJSZW1vdmUgdGl0bGUgc3ltYm9sXCIpXG4gICAgICAuc2V0RGVzYyhcIlJlbW92ZSB0aXRsZSBzeW1ib2wgb2YgdGhlIGZpbGUuXCIpXG4gICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmZvcm1hdC50aXRsZSlcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmZvcm1hdC50aXRsZSA9IHZhbHVlO1xuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICB9KSk7XG4gIH1cbn0iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsc0JBQTZIO0FBb0Q3SCxJQUFxQixjQUFyQixjQUF5Qyx1QkFBTztBQUFBLEVBQWhEO0FBQUE7QUFLRSw2QkFBbUMsQ0FBQztBQUFBO0FBQUEsRUFJcEMsTUFBTSxTQUFTO0FBQ2IsVUFBTSxLQUFLLGFBQWE7QUFDeEIsU0FBSyxjQUFjLElBQUksc0JBQXNCLEtBQUssS0FBSyxJQUFJLENBQUM7QUFFNUQsVUFBTSxLQUFLLFdBQVc7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
