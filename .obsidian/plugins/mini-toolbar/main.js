"use strict";/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source visit the plugins github repository
*/

var ue=Object.create;var F=Object.defineProperty,me=Object.defineProperties,de=Object.getOwnPropertyDescriptor,he=Object.getOwnPropertyDescriptors,pe=Object.getOwnPropertyNames,W=Object.getOwnPropertySymbols,ge=Object.getPrototypeOf,it=Object.prototype.hasOwnProperty,gt=Object.prototype.propertyIsEnumerable;var pt=(t,e,o)=>e in t?F(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,rt=(t,e)=>{for(var o in e||(e={}))it.call(e,o)&&pt(t,o,e[o]);if(W)for(var o of W(e))gt.call(e,o)&&pt(t,o,e[o]);return t},st=(t,e)=>me(t,he(e));var xt=(t,e)=>{var o={};for(var n in t)it.call(t,n)&&e.indexOf(n)<0&&(o[n]=t[n]);if(t!=null&&W)for(var n of W(t))e.indexOf(n)<0&&gt.call(t,n)&&(o[n]=t[n]);return o};var wt=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),xe=(t,e)=>{for(var o in e)F(t,o,{get:e[o],enumerable:!0})},bt=(t,e,o,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of pe(e))!it.call(t,i)&&i!==o&&F(t,i,{get:()=>e[i],enumerable:!(n=de(e,i))||n.enumerable});return t};var yt=(t,e,o)=>(o=t!=null?ue(ge(t)):{},bt(e||!t||!t.__esModule?F(o,"default",{value:t,enumerable:!0}):o,t)),we=t=>bt(F({},"__esModule",{value:!0}),t);var D=(t,e,o)=>new Promise((n,i)=>{var r=c=>{try{l(o.next(c))}catch(a){i(a)}},s=c=>{try{l(o.throw(c))}catch(a){i(a)}},l=c=>c.done?n(c.value):Promise.resolve(c.value).then(r,s);l((o=o.apply(t,e)).next())});var Ot=wt(Pt=>{var be=Object.create,z=Object.defineProperty,ye=Object.getOwnPropertyDescriptor,ve=Object.getOwnPropertyNames,Pe=Object.getPrototypeOf,Oe=Object.prototype.hasOwnProperty,vt=t=>z(t,"__esModule",{value:!0}),Ce=(t,e)=>{vt(t);for(var o in e)z(t,o,{get:e[o],enumerable:!0})},Ae=(t,e,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of ve(e))!Oe.call(t,n)&&n!=="default"&&z(t,n,{get:()=>e[n],enumerable:!(o=ye(e,n))||o.enumerable});return t},Me=t=>Ae(vt(z(t!=null?be(Pe(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);Ce(Pt,{getApi:()=>Te,isPluginEnabled:()=>Se});var so=Me(require("obsidian")),Te=t=>{var e;return t?(e=t.app.plugins.plugins["obsidian-icon-shortcodes"])==null?void 0:e.api:window.IconSCAPIv0},Se=t=>t.app.plugins.enabledPlugins.has("obsidian-icon-shortcodes")});var Nt=wt((vo,_t)=>{"use strict";_t.exports=function t(e,o){if(e===o)return!0;if(e&&o&&typeof e=="object"&&typeof o=="object"){if(e.constructor!==o.constructor)return!1;var n,i,r;if(Array.isArray(e)){if(n=e.length,n!=o.length)return!1;for(i=n;i--!==0;)if(!t(e[i],o[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===o.source&&e.flags===o.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===o.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===o.toString();if(r=Object.keys(e),n=r.length,n!==Object.keys(o).length)return!1;for(i=n;i--!==0;)if(!Object.prototype.hasOwnProperty.call(o,r[i]))return!1;for(i=n;i--!==0;){var s=r[i];if(!t(e[s],o[s]))return!1}return!0}return e!==e&&o!==o}});var oo={};xe(oo,{default:()=>et});module.exports=we(oo);var ce=require("obsidian");var re=yt(Ot()),L=require("@codemirror/language"),se=require("@codemirror/state"),y=require("obsidian");var Kt=require("@codemirror/state");var Ct="editor-mini-toolbar";var Xt=require("@codemirror/view");function U(t){return t.split("-")[0]}function Tt(t){return t.split("-")[1]}function lt(t){return["top","bottom"].includes(U(t))?"x":"y"}function St(t){return t==="y"?"height":"width"}function At(t){let{reference:e,floating:o,placement:n}=t,i=e.x+e.width/2-o.width/2,r=e.y+e.height/2-o.height/2,s;switch(U(n)){case"top":s={x:i,y:e.y-o.height};break;case"bottom":s={x:i,y:e.y+e.height};break;case"right":s={x:e.x+e.width,y:r};break;case"left":s={x:e.x-o.width,y:r};break;default:s={x:e.x,y:e.y}}let l=lt(n),c=St(l);switch(Tt(n)){case"start":s[l]=s[l]-(e[c]/2-o[c]/2);break;case"end":s[l]=s[l]+(e[c]/2-o[c]/2);break}return s}var Et=async(t,e,o)=>{let{placement:n="bottom",strategy:i="absolute",middleware:r=[],platform:s}=o,l=await s.getElementRects({reference:t,floating:e,strategy:i}),{x:c,y:a}=At({...l,placement:n}),u=n,d={},f=0;for(let h=0;h<r.length;h++){let{name:m,fn:w}=r[h],{x:b,y:p,data:x,reset:g}=await w({x:c,y:a,initialPlacement:n,placement:u,strategy:i,middlewareData:d,rects:l,platform:s,elements:{reference:t,floating:e}});if(c=b??c,a=p??a,d={...d,[m]:x??{}},g){typeof g=="object"&&(g.placement&&(u=g.placement),g.rects&&(l=g.rects===!0?await s.getElementRects({reference:t,floating:e,strategy:i}):g.rects),{x:c,y:a}=At({...l,placement:u})),h=-1;continue}}return{x:c,y:a,placement:u,strategy:i,middlewareData:d}};function Ee(t){return{top:0,right:0,bottom:0,left:0,...t}}function Re(t){return typeof t!="number"?Ee(t):{top:t,right:t,bottom:t,left:t}}function X(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}async function V(t,e){e===void 0&&(e={});let{x:o,y:n,platform:i,rects:r,elements:s,strategy:l}=t,{boundary:c="clippingParents",rootBoundary:a="viewport",elementContext:u="floating",altBoundary:d=!1,padding:f=0}=e,h=Re(f),w=s[d?u==="floating"?"reference":"floating":u],b=await i.getClippingClientRect({element:await i.isElement(w)?w:w.contextElement||await i.getDocumentElement({element:s.floating}),boundary:c,rootBoundary:a}),p=X(await i.convertOffsetParentRelativeRectToViewportRelativeRect({rect:u==="floating"?{...r.floating,x:o,y:n}:r.reference,offsetParent:await i.getOffsetParent({element:s.floating}),strategy:l}));return{top:b.top-p.top+h.top,bottom:p.bottom-b.bottom+h.bottom,left:b.left-p.left+h.left,right:p.right-b.right+h.right}}var ke={left:"right",right:"left",bottom:"top",top:"bottom"};function $(t){return t.replace(/left|right|bottom|top/g,e=>ke[e])}function Be(t,e){let o=Tt(t)==="start",n=lt(t),i=St(n),r=n==="x"?o?"right":"left":o?"bottom":"top";return e.reference[i]>e.floating[i]&&(r=$(r)),{main:r,cross:$(r)}}var De={start:"end",end:"start"};function Mt(t){return t.replace(/start|end/g,e=>De[e])}function Ie(t){let e=$(t);return[Mt(t),e,Mt(e)]}var ct=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var o,n;let{placement:i,middlewareData:r,rects:s,initialPlacement:l}=e;if((o=r.flip)!=null&&o.skip)return{};let{mainAxis:c=!0,crossAxis:a=!0,fallbackPlacements:u,fallbackStrategy:d="bestFit",flipAlignment:f=!0,...h}=t,m=U(i),b=u||(m===l||!f?[$(l)]:Ie(l)),p=[l,...b],x=await V(e,h),g=[],v=((n=r.flip)==null?void 0:n.overflows)||[];if(c&&g.push(x[m]),a){let{main:M,cross:k}=Be(i,s);g.push(x[M],x[k])}if(v=[...v,{placement:i,overflows:g}],!g.every(M=>M<=0)){var C,ot;let M=((C=(ot=r.flip)==null?void 0:ot.index)!=null?C:0)+1,k=p[M];if(k)return{data:{index:M,overflows:v},reset:{placement:k}};let B="bottom";switch(d){case"bestFit":{var A;let N=(A=v.slice().sort((ae,fe)=>ae.overflows.filter(R=>R>0).reduce((R,nt)=>R+nt,0)-fe.overflows.filter(R=>R>0).reduce((R,nt)=>R+nt,0))[0])==null?void 0:A.placement;N&&(B=N);break}case"initialPlacement":B=l;break}return{data:{skip:!0},reset:{placement:B}}}return{}}}};function je(t){let{placement:e,rects:o,value:n}=t,i=U(e),r=["left","top"].includes(i)?-1:1,s=typeof n=="function"?n({...o,placement:e}):n,{mainAxis:l,crossAxis:c}=typeof s=="number"?{mainAxis:s,crossAxis:0}:{mainAxis:0,crossAxis:0,...s};return lt(i)==="x"?{x:c,y:l*r}:{x:l*r,y:c}}var at=function(t){return t===void 0&&(t=0),{name:"offset",options:t,fn(e){let{x:o,y:n,placement:i,rects:r}=e,s=je({placement:i,rects:r,value:t});return{x:o+s.x,y:n+s.y,data:s}}}};function ut(t){return t?.toString()==="[object Window]"}function T(t){if(t==null)return window;if(!ut(t)){let e=t.ownerDocument;return e&&e.defaultView||window}return t}function K(t){return T(t).getComputedStyle(t)}function P(t){return ut(t)?"":t?(t.nodeName||"").toLowerCase():""}function O(t){return t instanceof T(t).HTMLElement}function Y(t){return t instanceof T(t).Element}function Le(t){return t instanceof T(t).Node}function It(t){let e=T(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function G(t){let{overflow:e,overflowX:o,overflowY:n}=K(t);return/auto|scroll|overlay|hidden/.test(e+n+o)}function Fe(t){return["table","td","th"].includes(P(t))}function jt(t){let e=navigator.userAgent.toLowerCase().includes("firefox"),o=K(t);return o.transform!=="none"||o.perspective!=="none"||o.contain==="paint"||["transform","perspective"].includes(o.willChange)||e&&o.willChange==="filter"||e&&(o.filter?o.filter!=="none":!1)}var Rt=Math.min,H=Math.max,q=Math.round;function I(t,e){e===void 0&&(e=!1);let o=t.getBoundingClientRect(),n=1,i=1;return e&&O(t)&&(n=t.offsetWidth>0&&q(o.width)/t.offsetWidth||1,i=t.offsetHeight>0&&q(o.height)/t.offsetHeight||1),{width:o.width/n,height:o.height/i,top:o.top/i,right:o.right/n,bottom:o.bottom/i,left:o.left/n,x:o.left/n,y:o.top/i}}function S(t){return((Le(t)?t.ownerDocument:t.document)||window.document).documentElement}function J(t){return ut(t)?{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}:{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function Lt(t){return I(S(t)).left+J(t).scrollLeft}function Ve(t){let e=I(t);return q(e.width)!==t.offsetWidth||q(e.height)!==t.offsetHeight}function He(t,e,o){let n=O(e),i=S(e),r=I(t,n&&Ve(e)),s={scrollLeft:0,scrollTop:0},l={x:0,y:0};if(n||!n&&o!=="fixed")if((P(e)!=="body"||G(i))&&(s=J(e)),O(e)){let c=I(e,!0);l.x=c.x+e.clientLeft,l.y=c.y+e.clientTop}else i&&(l.x=Lt(i));return{x:r.left+s.scrollLeft-l.x,y:r.top+s.scrollTop-l.y,width:r.width,height:r.height}}function Q(t){return P(t)==="html"?t:t.assignedSlot||t.parentNode||(It(t)?t.host:null)||S(t)}function kt(t){return!O(t)||getComputedStyle(t).position==="fixed"?null:t.offsetParent}function _e(t){let e=Q(t);for(;O(e)&&!["html","body"].includes(P(e));){if(jt(e))return e;e=e.parentNode}return null}function ft(t){let e=T(t),o=kt(t);for(;o&&Fe(o)&&getComputedStyle(o).position==="static";)o=kt(o);return o&&(P(o)==="html"||P(o)==="body"&&getComputedStyle(o).position==="static"&&!jt(o))?e:o||_e(t)||e}function Bt(t){return{width:t.offsetWidth,height:t.offsetHeight}}function Ne(t){let{rect:e,offsetParent:o,strategy:n}=t,i=O(o),r=S(o);if(o===r)return e;let s={scrollLeft:0,scrollTop:0},l={x:0,y:0};if((i||!i&&n!=="fixed")&&((P(o)!=="body"||G(r))&&(s=J(o)),O(o))){let c=I(o,!0);l.x=c.x+o.clientLeft,l.y=c.y+o.clientTop}return{...e,x:e.x-s.scrollLeft+l.x,y:e.y-s.scrollTop+l.y}}function We(t){let e=T(t),o=S(t),n=e.visualViewport,i=o.clientWidth,r=o.clientHeight,s=0,l=0;return n&&(i=n.width,r=n.height,Math.abs(e.innerWidth/n.scale-n.width)<.01&&(s=n.offsetLeft,l=n.offsetTop)),{width:i,height:r,x:s,y:l}}function ze(t){var e;let o=S(t),n=J(t),i=(e=t.ownerDocument)==null?void 0:e.body,r=H(o.scrollWidth,o.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=H(o.scrollHeight,o.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),l=-n.scrollLeft+Lt(t),c=-n.scrollTop;return K(i||o).direction==="rtl"&&(l+=H(o.clientWidth,i?i.clientWidth:0)-r),{width:r,height:s,x:l,y:c}}function Ft(t){return["html","body","#document"].includes(P(t))?t.ownerDocument.body:O(t)&&G(t)?t:Ft(Q(t))}function Vt(t,e){var o;e===void 0&&(e=[]);let n=Ft(t),i=n===((o=t.ownerDocument)==null?void 0:o.body),r=T(n),s=i?[r].concat(r.visualViewport||[],G(n)?n:[]):n,l=e.concat(s);return i?l:l.concat(Vt(Q(s)))}function $e(t,e){let o=e.getRootNode==null?void 0:e.getRootNode();if(t.contains(e))return!0;if(o&&It(o)){let n=e;do{if(n&&t===n)return!0;n=n.parentNode||n.host}while(n)}return!1}function Ue(t){let e=I(t),o=e.top+t.clientTop,n=e.left+t.clientLeft;return{top:o,left:n,x:n,y:o,right:n+t.clientWidth,bottom:o+t.clientHeight,width:t.clientWidth,height:t.clientHeight}}function Dt(t,e){return e==="viewport"?X(We(t)):Y(e)?Ue(e):X(ze(S(t)))}function Xe(t){let e=Vt(Q(t)),n=["absolute","fixed"].includes(K(t).position)&&O(t)?ft(t):t;return Y(n)?e.filter(i=>Y(i)&&$e(i,n)&&P(i)!=="body"):[]}function Ye(t){let{element:e,boundary:o,rootBoundary:n}=t,r=[...o==="clippingParents"?Xe(e):[].concat(o),n],s=r[0],l=r.reduce((c,a)=>{let u=Dt(e,a);return c.top=H(u.top,c.top),c.right=Rt(u.right,c.right),c.bottom=Rt(u.bottom,c.bottom),c.left=H(u.left,c.left),c},Dt(e,s));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}var qe={getElementRects:t=>{let{reference:e,floating:o,strategy:n}=t;return{reference:He(e,ft(o),n),floating:{...Bt(o),x:0,y:0}}},convertOffsetParentRelativeRectToViewportRelativeRect:t=>Ne(t),getOffsetParent:t=>{let{element:e}=t;return ft(e)},isElement:t=>Y(t),getDocumentElement:t=>{let{element:e}=t;return S(e)},getClippingClientRect:t=>Ye(t),getDimensions:t=>{let{element:e}=t;return Bt(e)},getClientRects:t=>{let{element:e}=t;return e.getClientRects()}},Ht=(t,e,o)=>Et(t,e,{platform:qe,...o});var Yt=yt(Nt()),E=require("obsidian");var Wt=require("@codemirror/state"),Z=Wt.Facet.define({combine:t=>{var e,o;return{defaultPlacement:((e=t.find(n=>n.defaultPlacement))==null?void 0:e.defaultPlacement)||"top",padding:((o=t.find(n=>n.padding))==null?void 0:o.padding)||8}}});var tt=t=>t.split("-")[0];var zt=t=>t==="x"?"y":"x";var $t=t=>["top","bottom"].includes(tt(t))?"x":"y";var j=(t,e,o)=>Math.max(t,Math.min(e,o));var Ke=(t,e)=>Object.fromEntries(Object.entries(t).map(([o,n],i)=>[o,e(n,o,i)])),Ge=t=>t===void 0?t:typeof t=="number"?-t:Ke(t,e=>e!==void 0?-e:e),Ut=(t={})=>({name:"shift",fn:e=>D(void 0,null,function*(){let{x:o,y:n,placement:i}=e,b=t,{mainAxis:r=!0,crossAxis:s=!1,limiter:l=({x:p,y:x})=>({x:p,y:x}),editorMenu:c}=b,a=xt(b,["mainAxis","crossAxis","limiter","editorMenu"]),u={x:o,y:n},d=yield V(e,a),f=$t(tt(i)),h=zt(f),m=u[f],w=u[h];if(r){let p=f==="y"?"top":"left",x=f==="y"?"bottom":"right",g=m+d[p],v=m-d[x];if(c){let C=yield V(e,st(rt({},a),{boundary:c.dom,padding:Ge(a.padding)}));if((h==="y"?["top","bottom"]:["left","right"]).every(A=>C[A]<=0)){let A=e.rects.floating.width,M=m+C[p]-A,k=m-C[x]+A,B=Math.abs(d[p]-C[p]),N=Math.abs(d[x]-C[x]);B>=A||N<B?m=j(g,m,M):m=j(k,m,v)}else m=j(g,m,v)}else m=j(g,m,v)}if(s){let p=h==="y"?"top":"left",x=h==="y"?"bottom":"right",g=w+d[p],v=w-d[x];w=j(g,w,v)}return l(st(rt({},e),{[f]:m,[h]:w}))})});var Je=(t=0,e=0)=>({width:0,height:0,top:e,left:t,bottom:e,right:t,x:t,y:e}),Qe=(t,e)=>{if(!t)return null;let o={left:t.left,right:t.right,top:t.top,bottom:t.bottom,width:0,height:t.bottom-t.top,x:t.top,y:t.left};return e&&(o.width=Math.abs(e.left-t.left)),o},Ze=Je(),mt=class{constructor(e){this.view=e;this.containerEl=this.view.dom;this.toolbar=null;this.inView=!0;this.defaultPlacement=this.view.state.facet(Z).defaultPlacement;this.cachedRefRect=null;this.readFromDOM=()=>{if(this.tooltipInfo){let{start:e,end:o}=this.tooltipInfo;o&&e===o&&(o=void 0);let n=this.view.coordsAtPos(e),i=o?this.view.coordsAtPos(o):null;if(n&&i&&n.top!==i.top){let s=this.view.contentDOM.getBoundingClientRect();i={left:s.right,right:s.right,top:n.top,bottom:n.bottom}}let r=Qe(n,i);r&&(this.cachedRefRect=r,this.computePosition(r))}};this.tooltipInfo=e.state.facet(_),this.virtualEl={rect:Ze,getBoundingClientRect(){return this.rect}},this.maybeMeasure(),this.editorMenu={currMenu:null,evtRef:e.state.field(E.editorInfoField)}}get workspace(){return this.view.state.field(E.editorInfoField).app.workspace}shouldRemoveToolbar(e){let o=e!=null?e:this.tooltipInfo;return!((o==null?void 0:o.end)||this.editorMenu.currMenu)}onEditorMenuOpen(e){this.editorMenu.currMenu||(this.editorMenu.currMenu=e,this.cachedRefRect?this.computePosition(this.cachedRefRect):this.maybeMeasure(),!E.Platform.isMacOS&&this.tooltipInfo&&(this.createToolbar(),this.maybeMeasure()))}onEditorMenuClose(e){this.editorMenu.currMenu===e&&(this.editorMenu.currMenu=null),!E.Platform.isMacOS&&this.toolbar&&this.shouldRemoveToolbar()&&this.removeToolbar()}createToolbar(e){let o=e!=null?e:this.tooltipInfo;if(!o)return;this.removeToolbar();let n=o.create(this.containerEl),i=this.view.state.field(E.editorInfoField);if(!i||!(i!=null&&i.editor))return;let r=i.editor.offsetToPos(o.start),s=o.end?i.editor.offsetToPos(o.end):r;this.workspace.trigger(Ct,n,{from:r,to:s},i.editor,i),this.toolbar=n}removeToolbar(){!this.toolbar||(this.toolbar.hide(),this.toolbar=null)}update(e){let o=e.state.facet(_),n=o!==this.tooltipInfo&&!(0,Yt.default)(o,this.tooltipInfo);n&&(this.tooltipInfo=o,this.shouldRemoveToolbar()?this.removeToolbar():o&&!this.toolbar&&this.createToolbar(o));let i=n||e.geometryChanged,r=e.state.facet(Z);r.defaultPlacement!=this.defaultPlacement&&(r.defaultPlacement=this.defaultPlacement),i&&this.maybeMeasure()}destroy(){this.editorMenu.currMenu=null,this.removeToolbar(),this.toolbar=null,this.view.state.field(E.editorInfoField).app.workspace.offref(this.editorMenu.evtRef)}computePosition(e){return D(this,null,function*(){if(!this.toolbar)return;this.virtualEl.rect=e;let{padding:o}=this.view.state.facet(Z),{x:n,y:i}=yield Ht(this.virtualEl,this.toolbar.dom,{placement:this.defaultPlacement,middleware:[at({mainAxis:5}),ct({padding:o,boundary:this.view.scrollDOM}),Ut({padding:o,boundary:this.view.scrollDOM,editorMenu:this.editorMenu.currMenu})]});Object.assign(this.toolbar.dom.style,{top:"0",left:"0",transform:`translate(${Math.round(n)}px,${Math.round(i)}px)`})})}maybeMeasure(){this.view.inView&&this.toolbar&&this.view.requestMeasure({read:this.readFromDOM}),this.inView!=this.view.inView&&(this.inView=this.view.inView,this.inView)}},to=Xt.ViewPlugin.fromClass(mt,{eventHandlers:{scroll(){this.maybeMeasure()}}}),qt=to;var _=Kt.Facet.define({enables:[qt],combine:t=>{var e;return(e=t.filter(o=>o!=null).first())!=null?e:null}});var Gt=require("obsidian"),Jt=t=>{let e=ne(t);if(!e)return;let o=e.getSelection();window.navigator.clipboard.writeText(e.getSelection()),e.replaceSelection("",o)},Qt=t=>{let e=ne(t);!e||window.navigator.clipboard.writeText(e==null?void 0:e.getSelection())},Zt=t=>{t.commands.executeCommandById("editor:toggle-bold",t)},te=t=>{t.commands.executeCommandById("editor:toggle-strikethrough",t)},ee=t=>{t.commands.executeCommandById("editor:toggle-highlight",t)},oe=t=>{t.commands.executeCommandById("editor:toggle-italics",t)},ne=t=>{let{editor:e}=t.field(Gt.editorInfoField);return e};var ie=(t,e)=>{let o=t.selection.ranges[0];if(!o)return null;let{anchor:n,head:i,empty:r}=o,[s,l]=[n,i].sort(),c=t.doc.lineAt(o.from).number!==t.doc.lineAt(o.to).number;return{start:s,end:r?void 0:l,create:u=>{let d=new ht(u).addSmallButton(f=>f.setIcon("scissors").onClick(()=>Jt(t))).addSmallButton(f=>f.setIcon("copy").onClick(()=>Qt(t))).addSmallButton(f=>f.setIcon("bold").onClick(()=>Zt(e))).addSmallButton(f=>f.setIcon("italic").onClick(()=>oe(e))).addSmallButton(f=>f.setIcon("strikethrough").onClick(()=>te(e)));return c&&d.addSmallButton(f=>f.setIcon("highlighter").onClick(()=>ee(e))),d}}},eo=t=>se.StateField.define({create:e=>ie(e,t),update:(e,o)=>!o.docChanged&&!o.selection?e:ie(o.state,t),provide:e=>_.from(e)}),le=t=>[eo(t)],dt=class extends y.BaseComponent{constructor(o){super();this.disabled=!1;this.dropdownOptions=[];this.menuOpened=!1;this.button=new y.ButtonComponent(o)}setDisabled(o){return this.button.setDisabled(o),this.disabled=o,this}setIcon(o){this.button.setIcon(o);let i,r;if(!this.button.buttonEl.querySelector("svg")&&(i=(0,re.getApi)())&&(r=i.getIcon(o,!1))){let s={width:14,height:14};typeof r=="string"?this.button.buttonEl.createDiv({text:r,attr:s}):(Object.assign(r,s),this.button.buttonEl.appendChild(r))}return this}setClass(o){return this.button.setClass(o),this}setDropdownText(o){var c;let n=this.button.buttonEl.createDiv("mini-toolbar-text"),i=this.button.buttonEl.createDiv("mini-toolbar-icon-with-text");(0,y.setIcon)(i,"chevron-down");let r=(c=o.doc.lineAt(o.selection.ranges[0].from))==null?void 0:c.from,s=(0,L.syntaxTree)(o).resolveInner(r+1),l=s.type.prop(L.tokenClassNodeProp);return n.setText(this.detectFormat(l,s)||"Text"),this}setDropdownIcon(){let o=this.button.buttonEl.createDiv("mini-toolbar-highlight-icon"),n=this.button.buttonEl.createDiv("mini-toolbar-icon-with-icon");return(0,y.setIcon)(o,"highlighter"),(0,y.setIcon)(n,"chevron-down"),this}detectFormat(o,n){var i;if(!o)return"Text";if(o.includes("strong"))return"Bold";if(o.includes("em"))return"Italic";if(o.includes("strikethrough"))return"Strike";if(o.contains("hmd-codeblock"))return"CodeBlock";if(o.contains("hmd-inline-code"))return"Code";if(o.contains("formatting-header")){let r=o.match(/header-\d{1,}/);if(r)return"Heading "+r[0].slice(-1)}if(o.contains("formatting-list")||o.contains("hmd-list-indent")){if(n!=null&&n.parent){let r=(i=n.parent)==null?void 0:i.type.prop(L.lineClassNodeProp);if(r!=null&&r.contains("HyperMD-task-line"))return"To-do list"}if(o.contains("formatting-list-ol"))return"Numbered list";if(o.contains("formatting-list-ul"))return"Bulleted list"}}setTooltip(o){return this.button.setTooltip(o),this}setOptionsList(o){return this.dropdownOptions=o,this}onClick(o){return this.dropdownOptions.length>0?(this.button.onClick(n=>this.showEditMenu(n)),this):(this.button.onClick(o),this)}showEditMenu(o){var s,l;if(console.log(this.menuOpened),this.menuOpened=!this.menuOpened,!this.menuOpened)return;this.menu=new y.Menu,this.menu.onHide(()=>{this.menuOpened=!1});let n=o.currentTarget,i=(s=o.currentTarget)==null?void 0:s.getBoundingClientRect(),r={x:i.left-6,y:i.bottom+6};for(let c=0;c<((l=this.dropdownOptions)==null?void 0:l.length);c++)this.menu.addItem(a=>{a.setIcon("zap").setTitle(this.dropdownOptions[c]).onClick(()=>{console.log("Hellow")})});this.menu.setParentElement(n).showAtPosition(r)}then(o){return o(this),this}},ht=class extends y.Component{constructor(o){super();this.unloading=!1;this.dom=o.createDiv({cls:"cm-mini-toolbar"},n=>n.style.position="absolute"),this.smallBtnContainer=this.dom}addSmallButton(o){return o(new dt(this.smallBtnContainer)),this}hide(){return this.unload(),this.unloading?this:(this.unloading=!0,this.dom.detach(),this.unloading=!1,this)}};var et=class extends ce.Plugin{onload(){return D(this,null,function*(){console.log("loading MiniToolbar"),this.registerEditorExtension(le(this.app))})}};
